!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6eee19b2-739a-45a2-a82e-101f9e54e5fc",e._sentryDebugIdIdentifier="sentry-dbid-6eee19b2-739a-45a2-a82e-101f9e54e5fc")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5969],{85365:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/sql/templates",function(){return r(99171)}])},4729:function(e,t,r){"use strict";r.d(t,{x:function(){return l}});var n=r(79367),s=r(52983);function l(){let{replace:e=!0,arrayKeys:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=JSON.stringify(t),l=(0,s.useMemo)(()=>new Set(t),[r]),i=(0,n.useRouter)(),a=(0,s.useMemo)(()=>Object.fromEntries(Object.entries(i.query).map(e=>{let[t,r]=e;return l.has(t)?Array.isArray(r)?[t,r]:[t,[r]]:[t,r]})),[l,i.query]),o=(0,s.useCallback)(t=>{let r="function"==typeof t?t(a):t,n=Object.fromEntries(Object.entries({...a,...r}).filter(e=>{let[,t]=e;return!!t}));(e?i.replace:i.push)({pathname:i.pathname,query:n},void 0,{shallow:!0,scroll:!1})},[i,a,e]);return[a,o]}},31820:function(e,t,r){"use strict";var n=r(97458),s=r(56901),l=r(52983);t.Z=e=>{let{title:t,description:r,sql:i,onClick:a}=e,[o,c]=(0,l.useState)(!1);return(0,n.jsx)(s.Z,{title:t,loading:o,onClick:()=>void(c(!0),a(i,t)),description:r,className:"xl:h-48 p-6","data-sentry-element":"CardButton","data-sentry-component":"SQLCard","data-sentry-source-file":"SQLCard.tsx"})}},56901:function(e,t,r){"use strict";var n=r(97458),s=r(7245),l=r(2526),i=r(29247),a=r.n(i),o=r(52983),c=r(39635);t.Z=e=>{let t,{title:r,description:i,children:d,footer:u,url:f="",linkHref:m="",imgUrl:h,imgAlt:p,icon:x,className:y,loading:g=!1,fixedHeight:v=!0,hideChevron:j=!1,titleClass:b="",containerElement:N,...w}=e,C=f||m||w.onClick,S={},_=N&&o.isValidElement(N)?e=>(0,o.cloneElement)(N,{...e}):void 0;w.onClick?(t=null!=_?_:"button",S=w):m?(t=null!=_?_:a(),S={href:m,...w}):f?(t=null!=_?_:"a",S={href:f,...w}):(t=null!=_?_:"div",S=w);let E=["group relative text-left","bg-surface-100","border border-surface","rounded-md p-5 flex flex-row","transition ease-in-out duration-150"];C&&(E=[...E,"cursor-pointer","hover:bg-surface-200","hover:border-control"]),v&&(E=[...E,"h-32"]);let k=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:"mr-4 flex flex-col","data-sentry-component":"ImageContainer","data-sentry-source-file":"CardButton.tsx",children:t})},q=(0,n.jsxs)(n.Fragment,{children:[h&&(0,n.jsx)(k,{children:(0,n.jsx)("img",{className:" transition-all group-hover:scale-110 ",src:"".concat(h),alt:"".concat(p),width:"26"})}),x&&(0,n.jsx)(k,{children:x}),(0,n.jsxs)("div",{className:"flex h-full w-full flex-col space-y-2",children:["string"==typeof r?(0,n.jsx)("h5",{className:"text-foreground pr-5 ".concat(b),children:r}):r,(d||i)&&(0,n.jsxs)("div",{className:"flex w-full flex-1 flex-col",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:i}),(0,n.jsx)("div",{className:"w-full",children:d&&d})]}),u&&(0,n.jsx)("div",{className:"w-full !mt-auto",children:u})]}),C&&(0,n.jsx)("div",{className:" absolute right-4 top-4 text-foreground-lighter transition-all duration-200 group-hover:right-3 group-hover:text-foreground ",children:g?(0,n.jsx)(s.Z,{className:"animate-spin"}):j?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(l.Z,{})})]});return(0,n.jsx)(t,{...S,className:(0,c.cn)(E,y),"data-sentry-element":"Container","data-sentry-component":"CardButton","data-sentry-source-file":"CardButton.tsx",children:q})}},99171:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var n=r(97458),s=r(198),l=r(50663),i=r.n(l),a=r(79367),o=r(34549),c=r(63413),d=r(25214),u=r(20787),f=r(51303),m=r(40809),h=r(78066),p=r(69117),x=r(62880),y=r(63277),g=r(31820),v=r(3448),j=()=>{let e=(0,a.useRouter)(),{ref:t}=(0,c.UO)(),{profile:r}=(0,p.Un)(),{project:l}=(0,u.d2)(),[j]=i()(d.o,{type:"template"}),b=(0,x.B0)(),N=(0,m.Xo)(s.KA.CREATE,"user_content",{resource:{type:"sql",owner_id:null==r?void 0:r.id},subject:{id:null==r?void 0:r.id}}),{mutate:w}=(0,f.a)(),C=async(n,s)=>{if(!t)return console.error("Project ref is required");if(!l)return console.error("Project is required");if(!r)return console.error("Profile is required");if(!N)return(0,o.Am)("Your queries will not be saved as you do not have sufficient permissions");try{let i=(0,y.wI)({id:(0,h.k$)(),name:s,sql:n,owner_id:null==r?void 0:r.id,project_id:null==l?void 0:l.id});b.addSnippet({projectRef:t,snippet:i}),b.addNeedsSaving(i.id),e.push("/project/".concat(t,"/sql/").concat(i.id))}catch(e){o.Am.error("Failed to create new query: ".concat(e.message))}};return(0,n.jsx)("div",{className:"block h-full space-y-8 overflow-y-auto p-4 md:p-6","data-sentry-component":"SQLTemplates","data-sentry-source-file":"SQLTemplates.tsx",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h1",{className:"text-foreground mb-3 text-xl",children:"Scripts"}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Quick scripts to run on your database."}),(0,n.jsxs)("p",{className:"text-foreground-light text-sm",children:["Click on any script to fill the query box, modify the script, then click",(0,n.jsx)("span",{className:"text-code",children:"Run"}),"."]})]}),(0,n.jsx)("div",{className:"grid gap-4 sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 ",children:j.map(e=>(0,n.jsx)(g.Z,{title:e.title,description:e.description,sql:e.sql,onClick:(e,t)=>{C(e,t),w({action:v.b.SQL_EDITOR_TEMPLATE_CLICKED,properties:{templateName:t}})}},e.title))})]})})},b=r(49650);let N=()=>(0,n.jsx)(j,{"data-sentry-element":"SQLTemplates","data-sentry-component":"SqlEditorWelcome","data-sentry-source-file":"templates.tsx"});N.getLayout=e=>(0,n.jsx)(b.Z,{title:"SQL",children:e});var w=N},55060:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(97458),s=r(52983),l=r(99173),i=r(98160);function a(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function o(e){let{validate:t,...r}=e,[o,c]=(0,s.useReducer)(a,null),d=(0,l.TA)({validateOnBlur:!0,...r,validationSchema:r.validationSchema,initialValues:r.initialValues,onSubmit:r.onSubmit,validate:t||function(){return o}});return(0,n.jsx)("form",{id:r.id,name:r.name,onSubmit:d.handleSubmit,className:r.className,style:r.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,n.jsx)(i.o,{values:d.values,errors:d.errors,formContextOnChange:d.handleChange,handleBlur:d.handleBlur,touched:d.touched,fieldLevelValidation:function(e,t){c({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:r.children({errors:d.errors,touched:d.touched,isSubmitting:d.isSubmitting,isValidating:d.isValidating,submitCount:d.submitCount,initialValues:d.initialValues,values:d.values,handleReset:d.handleReset,resetForm:d.resetForm,setFieldValue:d.setFieldValue})})})}}},function(e){e.O(0,[4176,588,5154,656,8703,698,8682,8375,4439,69,8790,659,5741,3439,5313,6437,5206,2930,5445,8685,1859,7686,3182,1515,9386,9650,9774,2888,179],function(){return e(e.s=85365)}),_N_E=e.O()}]);