!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="42bc1d2a-161e-45bf-8e30-1731e204573b",e._sentryDebugIdIdentifier="sentry-dbid-42bc1d2a-161e-45bf-8e30-1731e204573b")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6526],{56979:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/logs/explorer",function(){return s(73720)}])},35606:function(e,t,s){"use strict";s.d(t,{_:function(){return i}});var n=s(28894),a=s(23346),r=s(98759);async function l(e,t){let{ref:s,sql:n}=e;if(!n)throw Error("SQL must be provided");let{data:r,error:l}=await (0,a.U2)("/platform/projects/{ref}/analytics/warehouse/query",{params:{path:{ref:s},query:{bq_sql:n}},signal:t});return l&&(0,a.S3)(l),r}let i=function(e){let{ref:t,sql:s}=e,{enabled:a,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.a)(r.d.warehouseQuery(t,s),e=>{let{signal:n}=e;return l({ref:t,sql:s},n)},{enabled:a,staleTime:1/0,cacheTime:9e5,refetchOnMount:!1,refetchInterval:!1,...i})}},17839:function(e,t,s){"use strict";s.d(t,{T:function(){return c}});var n=s(36457),a=s(64618),r=s(34549),l=s(23346),i=s(68085);async function o(e,t){let{projectRef:s,payload:n}=e,{data:a,error:r}=await (0,l.v_)("/platform/projects/{ref}/content",{params:{path:{ref:s}},body:{id:n.id,name:n.name,description:n.description,owner_id:n.owner_id,type:n.type,visibility:n.visibility,content:n.content,folder_id:n.folder_id},signal:t});return r&&(0,l.S3)(r),a}let c=function(){let{onError:e,onSuccess:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,n.NL)();return(0,a.D)(e=>o(e),{async onSuccess(e,s,n){let{projectRef:a}=s;await l.invalidateQueries(i.$.allContentLists(a)),await (null==t?void 0:t(e,s,n))},async onError(t,s,n){void 0===e?r.Am.error("Failed to insert content: ".concat(t.message)):e(t,s,n)},...s})}},16221:function(e,t,s){"use strict";s.d(t,{s:function(){return c}});var n=s(36457),a=s(64618),r=s(34549),l=s(23346),i=s(68085);async function o(e,t){let{projectRef:s,id:n,type:a,content:r,name:i,description:o}=e,{data:c,error:d}=await (0,l.r$)("/platform/projects/{ref}/content",{params:{path:{ref:s},query:{id:n}},body:{id:n,type:a,content:r,name:i,description:o},signal:t});return d&&(0,l.S3)(d),c[0]}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,n.NL)();return(0,a.D)(e=>o(e),{async onSuccess(t,s,n){let{projectRef:a}=s;await l.invalidateQueries(i.$.allContentLists(a)),await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?r.Am.error("Failed to update content: ".concat(e.message)):t(e,s,n)},...s})}},54800:function(e,t,s){"use strict";var n=s(97458),a=s(29247),r=s.n(a),l=s(18624),i=s(72866),o=s(52176),c=s(19224);t.Z=e=>{let{show:t,setShowUpgradePrompt:s}=e,a=(0,l.l)();return(0,n.jsxs)(i.Z,{hideFooter:!0,visible:t,closable:!0,size:"medium",header:"Log retention",onCancel:()=>s(!1),"data-sentry-element":"Modal","data-sentry-component":"UpgradePrompt","data-sentry-source-file":"UpgradePrompt.tsx",children:[(0,n.jsx)(i.Z.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm",children:"Logs can be retained up to a duration of 3 months depending on the plan that your project is on."}),(0,n.jsxs)("div",{className:"border-control bg-surface-300 rounded border",children:[(0,n.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,n.jsx)("p",{className:"text-foreground-light w-[40%] text-sm",children:"Plan"}),(0,n.jsx)("p",{className:"text-foreground-light w-[60%] text-sm",children:"Retention duration"})]}),(0,n.jsxs)("div",{className:"py-1",children:[(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Free"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:c.fg.FREE.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Pro"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:c.fg.PRO.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Team"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:c.fg.TEAM.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Enterprise"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:c.fg.ENTERPRISE.text})]})]})]})]})}),(0,n.jsx)(i.Z.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx"}),(0,n.jsxs)(i.Z.Content,{className:"flex justify-end gap-3","data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx",children:[(0,n.jsx)(o.z,{type:"default",onClick:()=>s(!1),"data-sentry-element":"Button","data-sentry-source-file":"UpgradePrompt.tsx",children:"Close"}),(0,n.jsx)(o.z,{asChild:!0,size:"tiny","data-sentry-element":"Button","data-sentry-source-file":"UpgradePrompt.tsx",children:(0,n.jsx)(r(),{href:"/org/".concat(null==a?void 0:a.slug,"/billing?panel=subscriptionPlan"),"data-sentry-element":"Link","data-sentry-source-file":"UpgradePrompt.tsx",children:"Upgrade"})})]})]})}},53198:function(e,t,s){"use strict";var n=s(97458),a=s(91837),r=s(61322),l=s(52983),i=s(78066),o=s(52176),c=s(39635);t.Z=e=>{var t;let{text:s,iconOnly:d=!1,children:u,onClick:m,copyLabel:p="Copy",copiedLabel:x="Copied",...h}=e,[f,y]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if(!f)return;let e=setTimeout(()=>y(!1),2e3);return()=>clearTimeout(e)},[f]),(0,n.jsx)(o.z,{onClick:async e=>{y(!0),await (0,i.vQ)(s),null==m||m(e)},...h,className:(0,c.cn)({"px-1":d},h.className),icon:f?(0,n.jsx)(a.Z,{strokeWidth:2,className:"text-brand"}):null!==(t=h.icon)&&void 0!==t?t:(0,n.jsx)(r.Z,{}),"data-sentry-element":"Button","data-sentry-component":"CopyButton","data-sentry-source-file":"CopyButton.tsx",children:!d&&(0,n.jsx)(n.Fragment,{children:null!=u?u:f?x:p})})}},49870:function(e,t,s){"use strict";s.d(t,{_:function(){return i}});var n=s(98632),a=s(35934),r=s(52983),l=s(18624);let i=e=>{var t;let s=(0,l.l)(),{data:i}=(0,a.Gl)({orgSlug:null==s?void 0:s.slug}),[o,c]=(0,r.useState)(!1),d=(0,n.dP)(e,null==i?void 0:null===(t=i.plan)||void 0===t?void 0:t.id);return(0,r.useEffect)(()=>{d&&c(!0)},[e]),{showUpgradePrompt:o,setShowUpgradePrompt:c,shouldShowUpgradePrompt:d}}},73720:function(e,t,s){"use strict";s.r(t),s.d(t,{LogsExplorerPage:function(){return er},default:function(){return el}});var n=s(97458),a=s(85638),r=s(28977),l=s.n(r),i=s(79367),o=s(52983),c=s(34549),d=s(63413),u=s(59520),m=s(72866),p=s(55060),x=s(399),h=s(52176),f=s(23382),y=s(19224),g=s(98632),j=s(29247),v=s.n(j),b=s(13948),w=s(76556),N=s(46272),_=s(53043),C=s(78066),S=s(21935),k=s(94849),E=s(48986),T=s(19215),Z=s(91837),P=s(61322),q=s(82954),L=s(99794),z=s(48963),R=s(10942),A=s(11971),D=s(6190),F=s(42756),I=s(68218);function O(e){let{name:t,desc:s}=e;return(0,n.jsxs)("div",{className:"grid gap-1","data-sentry-component":"DropdownMenuItemContent","data-sentry-source-file":"LogsQueryPanel.tsx",children:[(0,n.jsx)("div",{className:"font-mono font-bold",children:t}),s&&(0,n.jsx)("div",{className:"text-foreground-light",children:s})]})}let Q=e=>{let{field:t}=e,[s,a]=(0,o.useState)(!1);return(0,n.jsxs)(w.Z.tr,{"data-sentry-element":"unknown","data-sentry-component":"Field","data-sentry-source-file":"LogsQueryPanel.tsx",children:[(0,n.jsxs)(w.Z.td,{className:"font-mono text-xs !p-2 cursor-pointer hover:text-foreground transition flex items-center space-x-2",onClick:()=>(0,C.vQ)(t.path,()=>{a(!0),setTimeout(()=>a(!1),3e3)}),"data-sentry-element":"unknown","data-sentry-source-file":"LogsQueryPanel.tsx",children:[(0,n.jsx)("span",{children:t.path}),s?(0,n.jsxs)(b.fC,{delayDuration:0,children:[(0,n.jsx)(b.xz,{children:(0,n.jsx)(Z.Z,{size:14,strokeWidth:3,className:"text-brand"})}),(0,n.jsx)(b.h_,{children:(0,n.jsxs)(b.VY,{side:"bottom",children:[(0,n.jsx)(b.Eh,{className:"radix-tooltip-arrow"}),(0,n.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,n.jsx)("span",{className:"text-xs text-foreground",children:"Copied"})})]})})]}):(0,n.jsxs)(b.fC,{delayDuration:0,children:[(0,n.jsx)(b.xz,{children:(0,n.jsx)(P.Z,{size:14,strokeWidth:1.5})}),(0,n.jsx)(b.h_,{children:(0,n.jsxs)(b.VY,{side:"bottom",children:[(0,n.jsx)(b.Eh,{className:"radix-tooltip-arrow"}),(0,n.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,n.jsx)("span",{className:"text-xs text-foreground",children:"Copy value"})})]})})]})]}),(0,n.jsx)(w.Z.td,{className:"font-mono text-xs !p-2","data-sentry-element":"unknown","data-sentry-source-file":"LogsQueryPanel.tsx",children:t.type})]})};var U=e=>{let{templates:t=[],warehouseTemplates:s=[],onSelectTemplate:a,onSelectWarehouseTemplate:r,onSelectSource:l,defaultFrom:i,defaultTo:c,onDateChange:u,warnings:m,warehouseCollections:p,dataSource:x,onDataSourceChange:f}=e,[g,j]=(0,o.useState)(!1),{projectAuthAll:b,projectStorageAll:C,projectEdgeFunctionAll:Z}=(0,N.N)(["project_auth:all","project_storage:all","project_edge_function:all"]),P=(0,_.P)("warehouse"),U=Object.entries(y.U_).filter(e=>{let[t]=e;return"AUTH"===t?b:"STORAGE"===t?C:"FN_EDGE"===t?Z:"WAREHOUSE"!==t}).map(e=>{let[,t]=e;return t});return(0,n.jsx)("div",{className:"border-b bg-surface-100","data-sentry-component":"LogsQueryPanel","data-sentry-source-file":"LogsQueryPanel.tsx",children:(0,n.jsx)("div",{className:"flex w-full items-center justify-between px-5 py-2",children:(0,n.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[P&&(0,n.jsxs)(L.h_,{children:[(0,n.jsx)(L.$F,{asChild:!0,children:(0,n.jsxs)(h.z,{type:"default",iconRight:(0,n.jsx)(S.Z,{}),children:["Data source"," ",(0,n.jsx)("span",{className:"ml-2 font-mono opacity-50",children:"warehouse"===x?"collections":"logs"})]})}),(0,n.jsxs)(L.AW,{side:"bottom",align:"start",children:[(0,n.jsx)(L.Xi,{onClick:()=>f("logs"),children:(0,n.jsx)(O,{name:"Logs",desc:"Logs for all Supabase products"})}),(0,n.jsx)(L.Xi,{onClick:()=>f("warehouse"),children:(0,n.jsx)(O,{name:(0,n.jsxs)("span",{children:["Collections ",(0,n.jsx)(z.C,{variant:"warning",children:"NEW"})]}),desc:"Query your collections"})})]})]}),"warehouse"===x&&(0,n.jsxs)(L.h_,{children:[(0,n.jsx)(L.$F,{asChild:!0,children:(0,n.jsx)(h.z,{type:"default",iconRight:(0,n.jsx)(S.Z,{}),children:"Templates"})}),(0,n.jsxs)(L.AW,{className:"max-h-96 overflow-auto",side:"bottom",align:"start",children:[s.map(e=>(0,n.jsx)(L.Xi,{onClick:()=>r(e),children:(0,n.jsx)(O,{name:e.name,desc:e.description})},e.name)),0===p.length&&(0,n.jsx)(L.Xi,{className:"hover:bg-transparent cursor-default",children:(0,n.jsx)(O,{name:"No collections found",desc:"You can create collections in the left sidebar."})})]})]}),"logs"===x&&(0,n.jsxs)(L.h_,{children:[(0,n.jsx)(L.$F,{asChild:!0,children:(0,n.jsx)(h.z,{type:"default",iconRight:(0,n.jsx)(S.Z,{}),children:"Insert source"})}),(0,n.jsx)(L.AW,{side:"bottom",align:"start",className:"max-h-[70vh] overflow-auto",children:"logs"===x&&U.sort((e,t)=>e.localeCompare(t)).map(e=>(0,n.jsx)(L.Xi,{onClick:()=>l(e),children:(0,n.jsx)(O,{name:e,desc:y.tZ[e]})},e))})]}),"logs"===x&&d.Qy&&(0,n.jsxs)(L.h_,{children:[(0,n.jsx)(L.$F,{asChild:!0,children:(0,n.jsx)(h.z,{type:"default",iconRight:(0,n.jsx)(S.Z,{}),children:"Templates"})}),(0,n.jsx)(L.AW,{side:"bottom",align:"start",children:t.sort((e,t)=>e.label.localeCompare(t.label)).map(e=>(0,n.jsx)(L.Xi,{onClick:()=>a(e),children:(0,n.jsx)("p",{children:e.label})},e.label))})]}),"logs"===x&&(0,n.jsx)(I.Z,{to:c,from:i,onChange:u,helpers:y.up}),(0,n.jsx)("div",{className:"overflow-hidden",children:(0,n.jsx)("div",{className:" transition-all duration-300 ".concat(m.length>0?"opacity-100":"invisible h-0 w-0 opacity-0"),children:(0,n.jsx)(R.Z,{overlay:(0,n.jsx)(A.b,{variant:"warning",title:"",children:(0,n.jsx)("div",{className:"flex flex-col gap-3",children:m.map((e,t)=>(0,n.jsxs)("p",{children:[e.text," ",e.link&&(0,n.jsx)(v(),{href:e.link,children:e.linkText||"View"})]},t))})}),"data-sentry-element":"Popover","data-sentry-source-file":"LogsQueryPanel.tsx",children:(0,n.jsxs)(z.C,{variant:"warning","data-sentry-element":"Badge","data-sentry-source-file":"LogsQueryPanel.tsx",children:[m.length," ",m.length>1?"warnings":"warning"]})})})})]}),"logs"===x&&(0,n.jsxs)(D.ZP,{size:"large",header:(0,n.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,n.jsx)("h3",{children:"Field Reference"}),(0,n.jsx)(h.z,{type:"text",className:"px-1",onClick:()=>j(!1),icon:(0,n.jsx)(k.Z,{})})]}),visible:g,cancelText:"Close",onCancel:()=>j(!1),hideFooter:!0,triggerElement:(0,n.jsx)(h.z,{asChild:!0,type:"text",onClick:()=>j(!0),icon:(0,n.jsx)(E.Z,{}),className:"px-2",children:(0,n.jsx)("span",{children:"Field Reference"})}),children:[(0,n.jsx)(D.ZP.Content,{children:(0,n.jsx)("div",{className:"pt-4 pb-2 space-y-1",children:(0,n.jsxs)("p",{className:"text-sm",children:["The following table shows all the available paths that can be queried from each respective source. Do note that to access nested keys, you would need to perform the necessary"," ",(0,n.jsxs)(v(),{href:"https://supabase.com/docs/guides/platform/logs#unnesting-arrays",target:"_blank",rel:"noreferrer",className:"text-brand",children:["unnesting joins",(0,n.jsx)(T.Z,{size:"14",className:"ml-1 inline -translate-y-[2px]",strokeWidth:1.5})]})]})})}),(0,n.jsx)(D.ZP.Separator,{}),(0,n.jsx)(F.Z,{scrollable:!0,size:"small",type:"underlined",defaultActiveId:"edge_logs",listClassNames:"px-2",children:q._S.schemas.map(e=>(0,n.jsx)(F.Z.Panel,{id:e.reference,label:e.name,className:"px-4 pb-4",children:(0,n.jsx)(w.Z,{head:[(0,n.jsx)(w.Z.th,{className:"text-xs !p-2",children:"Path"},"path"),(0,n.jsx)(w.Z.th,{className:"text-xs !p-2",children:"Type"},"type")],body:e.fields.sort((e,t)=>e.path-t.path).map(e=>(0,n.jsx)(Q,{field:e},e.path))})},e.reference))})]})]})})})},M=s(84073),$=s(54800),W=s(75170),H=s(77554),V=s(90784),X=s(56081),B=s(1145),G=s(35606),Y=s(17839),K=s(35934),J=s(76732),ee=s(18624),et=s(49870),es=s(92787),en=s(16221);let ea=d.Qy?"select\n  cast(timestamp as datetime) as timestamp,\n  event_message, metadata \nfrom edge_logs \nlimit 5":"select\n  timestamp, event_message, metadata\n  from edge_logs limit 5",er=()=>{(0,g.Q9)();let e=(0,i.useRouter)(),{ref:t,q:s,ite:r,its:d}=(0,a.UO)(),j=(0,ee.l)(),[v,b]=(0,o.useState)((0,C.k$)()),[w,N]=(0,o.useState)((0,C.k$)()),[_,S]=(0,o.useState)(ea),[k,E]=(0,o.useState)("-- Fetch the last 10 logs in the last 7 days \nselect id, timestamp, event_message from `COLLECTION_NAME` \nwhere timestamp > timestamp_sub(current_timestamp(), interval 7 day) \norder by timestamp desc limit 10"),[T,Z]=(0,o.useState)(!1),[P,q]=(0,o.useState)([]),L=e.query.source,[z,R]=(0,o.useState)(L||"logs"),{data:A}=(0,K.Gl)({orgSlug:null==j?void 0:j.slug}),{params:D,logData:F,error:I,isLoading:O,changeQuery:Q,runQuery:W,setParams:er}=(0,J.Z)(t,{iso_timestamp_start:d||void 0,iso_timestamp_end:r||void 0},"logs"===z),{refetch:el,data:ei,isFetching:eo,error:ec}=(0,G._)({ref:t,sql:k},{enabled:!1});(0,o.useEffect)(()=>{ec&&c.Am.error(ec.message)},[ec]);let ed=O||eo,[eu,em]=(0,f._)("project-content-".concat(t,"-recent-log-sql"),[]),{data:ep}=(0,B.O)({projectRef:t}),ex=e=>{em([...eu,{schema_version:"1",favorite:!1,sql:"",content_id:"",...e}])},{showUpgradePrompt:eh,setShowUpgradePrompt:ef}=(0,et._)(D.iso_timestamp_start);(0,o.useEffect)(()=>{s&&(ey({mode:"custom",searchString:s}),E(s))},[s]),(0,o.useEffect)(()=>{let e=[],t=D.iso_timestamp_start?l()(D.iso_timestamp_start):l()(),s=D.iso_timestamp_end?l()(D.iso_timestamp_end):l()(),n=Math.abs(t.diff(s,"days"));_&&!_.includes("limit")&&n>y.$K&&e.push({text:"When querying large date ranges, include a LIMIT clause."}),q(e)},[_,D.iso_timestamp_start,D.iso_timestamp_end]),(0,o.useEffect)(()=>{if(d){var e;(0,g.dP)(d,null==A?void 0:null===(e=A.plan)||void 0===e?void 0:e.id)&&ef(!eh)}},[d,A]);let ey=t=>{S(t.searchString),Q(t.searchString),b((0,C.k$)()),e.push({pathname:e.pathname,query:{...e.query,q:t.searchString}}),ex({sql:t.searchString})},eg=t=>{let s="string"==typeof t&&t||_;if(t&&"string"==typeof t&&S(t),"warehouse"===z){if(!(null==ep?void 0:ep.length)){c.Am.error("You do not have any collections yet.");return}let t=null==ep?void 0:ep.map(e=>e.name);if(!(null==t?void 0:t.find(e=>k.includes(e)))){c.Am.error("Please specify a collection name in the query");return}if(Object.values(y.ae).find(e=>k.includes(e))){c.Am.error("Cannot query logs tables from current query.");return}el(),e.push({pathname:e.pathname,query:{...e.query,q:s}});return}Q(s),W(),e.push({pathname:e.pathname,query:{...e.query,q:s}}),ex({sql:s})};function ej(){let s=e.query.queryId;if(s){ew({projectRef:t,id:s,type:"log_sql",content:{sql:_}});return}Z(!T)}let{isLoading:ev,mutate:eb}=(0,Y.T)({onError:e=>{console.error(e),Z(!1),c.Am.error("Failed to save query: ".concat(e.message))},onSuccess:e=>{Z(!1),c.Am.success('Saved "'.concat(e.name,'" log query'))}}),{mutate:ew}=(0,en.s)({onError:e=>{console.error(e),Z(!1),c.Am.error("Failed to update query: ".concat(e.message))},onSuccess:e=>{Z(!1),c.Am.success('Updated "'.concat(e.name,'" log query'))}}),[eN,e_]=(0,o.useState)(null),eC="warehouse"===z?null==ei?void 0:ei.result:F;return(0,n.jsxs)("div",{className:"w-full h-full mx-auto","data-sentry-component":"LogsExplorerPage","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)(u.pO,{className:"w-full h-full max-h-screen",direction:"vertical",autoSaveId:es.dA.LOG_EXPLORER_SPLIT_SIZE,"data-sentry-element":"ResizablePanelGroup","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)(u.ee,{collapsible:!0,minSize:5,"data-sentry-element":"ResizablePanel","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(U,{defaultFrom:D.iso_timestamp_start||"",defaultTo:D.iso_timestamp_end||"",onDateChange:t=>{var s;let{to:n,from:a}=t;(0,g.dP)(a,null==A?void 0:null===(s=A.plan)||void 0===s?void 0:s.id)?ef(!eh):(er(e=>({...e,iso_timestamp_start:a||"",iso_timestamp_end:n||""})),e.push({pathname:e.pathname,query:{...e.query,its:a||"",ite:n||""}}))},onSelectSource:e=>{if("warehouse"===z){N((0,C.k$)());return}S(t=>{let s=t.indexOf("from");return -1===s?"".concat(t).concat(e):"".concat(t.substring(0,s+4)," ").concat(e," ").concat(t.substring(s+5))}),b((0,C.k$)())},onClear:()=>{S(""),b((0,C.k$)()),N((0,C.k$)()),Q("")},hasEditorValue:!!_,templates:y.xN.filter(e=>"custom"===e.mode),warehouseCollections:ep||[],onSelectTemplate:ey,warehouseTemplates:(ep||[]).flatMap(e=>[{query:"select count(*) as event_count from `".concat(e.name,"`\nwhere timestamp > timestamp_sub(current_timestamp(), interval 1 day)"),name:"".concat(e.name," - Daily Event Count"),description:"Count events in the last 24 hours from ".concat(e.name," collection")},{query:"select id, timestamp, event_message from `".concat(e.name,"`\n        where timestamp > timestamp_sub(current_timestamp(), interval 1 day) \n        and event_message like '%YOUR_TEXT_HERE%'\n        order by timestamp desc limit 10"),name:"".concat(e.name," - Filter by text"),description:"Select last 10 events from ".concat(e.name," collection")}]),onSelectWarehouseTemplate:e=>{E(e.query),N((0,C.k$)())},onSave:ej,isLoading:ed,warnings:P,dataSource:z,onDataSourceChange:t=>{R(t),e.push({pathname:e.pathname,query:{...e.query,source:t}})},"data-sentry-element":"LogsQueryPanel","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(X.Z,{active:ed,"data-sentry-element":"ShimmerLine","data-sentry-source-file":"index.tsx"}),"warehouse"===z?(0,n.jsx)(H.Z,{id:w,language:"pgsql",defaultValue:k,onInputChange:e=>E(e||""),actions:{runQuery:{enabled:!0,callback:eg}}}):(0,n.jsx)(H.Z,{id:v,language:"pgsql",defaultValue:_,onInputChange:e=>S(e||""),actions:{runQuery:{enabled:!0,callback:eg}}})]}),(0,n.jsx)(u.Dp,{withHandle:!0,"data-sentry-element":"ResizableHandle","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(u.ee,{collapsible:!0,minSize:5,className:"overflow-auto","data-sentry-element":"ResizablePanel","data-sentry-source-file":"index.tsx",children:(0,n.jsxs)(V.Z,{active:ed,"data-sentry-element":"LoadingOpacity","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(M.Z,{showHistogramToggle:!1,onRun:eg,onSave:ej,hasEditorValue:!!_,data:eC,error:I,projectRef:t,onSelectedLogChange:e_,selectedLog:eN,"data-sentry-element":"LogTable","data-sentry-source-file":"index.tsx"}),(0,n.jsx)("div",{className:"flex flex-row justify-end mt-2",children:(0,n.jsx)($.Z,{show:eh,setShowUpgradePrompt:ef,"data-sentry-element":"UpgradePrompt","data-sentry-source-file":"index.tsx"})})]})})]}),(0,n.jsx)(m.Z,{size:"medium",onCancel:()=>Z(!T),header:"Save log query",visible:T,hideFooter:!0,"data-sentry-element":"Modal","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(p.Z,{initialValues:{name:"",desdcription:""},onSubmit:async(e,s)=>{let{setSubmitting:n}=s;n(!0),eb({projectRef:t,payload:{id:(0,C.k$)(),name:e.name,description:e.description||"",type:"log_sql",content:{content_id:v,sql:_,schema_version:"1",favorite:!1},visibility:"user"}})},"data-sentry-element":"Form","data-sentry-source-file":"index.tsx",children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.Z.Content,{className:"space-y-6",children:[(0,n.jsx)(x.Z,{layout:"horizontal",label:"Name",id:"name"}),(0,n.jsx)("div",{className:"text-area-text-sm",children:(0,n.jsx)(x.Z.TextArea,{layout:"horizontal",labelOptional:"Optional",label:"Description",id:"description",rows:2})})]}),(0,n.jsx)(m.Z.Separator,{}),(0,n.jsxs)(m.Z.Content,{className:"flex items-center justify-end gap-2",children:[(0,n.jsx)(h.z,{size:"tiny",type:"default",onClick:()=>Z(!T),children:"Cancel"}),(0,n.jsx)(h.z,{size:"tiny",loading:ev,disabled:ev,htmlType:"submit",children:"Save"})]})]})})})]})};er.getLayout=e=>(0,n.jsx)(W.Z,{children:e});var el=er},78579:function(e,t,s){"use strict";s.d(t,{c:function(){return j},w:function(){return f}});var n=s(97458),a=s(52983),r=s(59158),l=s(39635),i=s(28977),o=s.n(i),c=s(60192),d=s.n(c),u=s(13516),m=s.n(u),p=s(61322);o().extend(d()),o().extend(m());let x=e=>o().unix(Number(e)/1e3/1e3).toISOString(),h=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},f=e=>{let{utcTimestamp:t,format:s}=e,n=h(t)?x(t):t;return o().utc(n).local().format(s)},y=e=>{let{utcTimestamp:t,format:s}=e,n=h(t)?x(t):t;return o().utc(n).format(s)},g=e=>{let{utcTimestamp:t}=e,s=h(t)?x(t):t;return o().utc(s).fromNow()},j=e=>{let{utcTimestamp:t,className:s,displayAs:i="local",format:o="DD MMM  HH:mm:ss",labelFormat:c="DD MMM HH:mm:ss"}=e,d=f({utcTimestamp:t,format:o}),u=y({utcTimestamp:t,format:o}),m=g({utcTimestamp:t}),[x,h]=(0,a.useState)("start"),j=(0,a.useRef)(null),v=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,a.useEffect)(()=>{let e=()=>{if(j.current){let e=j.current.getBoundingClientRect(),t=window.innerHeight;h(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let b=e=>{let{label:t,value:s}=e,[r,i]=(0,a.useState)(!1);return(0,n.jsxs)("span",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),navigator.clipboard.writeText(s),i(!0),setTimeout(()=>{i(!1)},1e3)},className:(0,l.cn)("relative cursor-default grid grid-cols-2 gap-2 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":r}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("span",{className:"text-right truncate",children:[t,":"]}),(0,n.jsxs)("div",{className:"relative",children:[r&&(0,n.jsx)("span",{className:"absolute inset-0 flex items-center text-brand-600 bg-surface-100",children:"Copied!"}),(0,n.jsxs)("span",{className:"flex items-center gap-x-2",children:[s,(0,n.jsx)(p.Z,{size:12,className:"opacity-0 group-hover:opacity-100 transition","data-sentry-element":"Clipboard","data-sentry-source-file":"index.tsx"})]})]})]})};return(0,n.jsxs)(r.u,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(r.aJ,{asChild:!0,ref:j,className:"text-xs ".concat(s," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("span",{children:"local"===i?f({utcTimestamp:t,format:c}):y({utcTimestamp:t,format:c})})}),(0,n.jsxs)(r._v,{align:x,side:"right",className:"font-mono p-0 py-1","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(b,{label:"UTC",value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"".concat(v),value:d,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Relative",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},42756:function(e,t,s){"use strict";var n=s(97458),a=s(77317),r=s(52983),l=s(86815);let i=e=>{var t,s,i;let{defaultActiveId:o,activeId:c,type:d="pills",size:u="tiny",block:m,onChange:p,onClick:x,scrollable:h,wrappable:f,addOnBefore:y,addOnAfter:g,listClassNames:j,baseClassNames:v,refs:b,children:w}=e,N=r.Children.toArray(w),[_,C]=(0,r.useState)(null!==(i=null!=c?c:o)&&void 0!==i?i:null==N?void 0:null===(s=N[0])||void 0===s?void 0:null===(t=s.props)||void 0===t?void 0:t.id);(0,r.useMemo)(()=>{c&&c!==_&&C(c)},[c]);let S=(0,l.Z)("tabs");function k(e){null==x||x(e),e!==_&&(null==p||p(e),C(e))}let E=[S[d].list];return h&&E.push(S.scrollable),f&&E.push(S.wrappable),j&&E.push(j),(0,n.jsxs)(a.fC,{value:_,className:[S.base,v].join(" "),ref:null==b?void 0:b.base,"data-sentry-element":"unknown","data-sentry-component":"Tabs","data-sentry-source-file":"Tabs.tsx",children:[(0,n.jsxs)(a.aV,{className:E.join(" "),ref:null==b?void 0:b.list,"data-sentry-element":"unknown","data-sentry-source-file":"Tabs.tsx",children:[y,N.map(e=>{let t=_===e.props.id,s=[S[d].base,S.size[u]];return t?s.push(S[d].active):s.push(S[d].inactive),m&&s.push(S.block),(0,n.jsxs)(a.xz,{onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),k(e.props.id))},onClick:()=>k(e.props.id),value:e.props.id,className:s.join(" "),children:[e.props.icon,(0,n.jsx)("span",{children:e.props.label}),e.props.iconRight]},"".concat(e.props.id,"-tab-button"))}),g]}),N]})};i.Panel=e=>{let{children:t,id:s,className:r}=e,i=(0,l.Z)("tabs");return(0,n.jsx)(a.VY,{value:s,className:[i.content,r].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Panel","data-sentry-source-file":"Tabs.tsx",children:t})},t.Z=i}},function(e){e.O(0,[4176,588,5154,656,8703,698,8682,8375,4439,69,8790,659,5741,3439,5313,6437,5206,8444,320,4138,2930,8685,1859,7686,3182,1515,9386,5170,7693,2355,9774,2888,179],function(){return e(e.s=56979)}),_N_E=e.O()}]);